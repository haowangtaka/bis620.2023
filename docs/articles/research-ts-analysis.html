<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Time Series Analysis for Clinical Studies â€¢ bis620.2023</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Time Series Analysis for Clinical Studies">
<meta property="og:description" content="bis620.2023">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bis620.2023</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/research-significance-analysis.html">Evaluating the Determinants and Evolution of Clinical Trial Outcome Significance</a>
    </li>
    <li>
      <a href="../articles/research-ts-analysis.html">Time Series Analysis for Clinical Studies</a>
    </li>
    <li>
      <a href="../articles/shiny-app-plots-demo.html">shiny-app-plots-demo</a>
    </li>
    <li>
      <a href="../articles/spectral-signatures.html">Spectral Signatures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Time Series Analysis for Clinical Studies</h1>
                        <h4 data-toc-skip class="author">Yixiao
Chen</h4>
            
            <h4 data-toc-skip class="date">2023-12-19</h4>
      
      
      <div class="hidden name"><code>research-ts-analysis.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background-and-motivation">Background and Motivation<a class="anchor" aria-label="anchor" href="#background-and-motivation"></a>
</h2>
<p>The ability to predict the number of clinical trials that will be
conducted each year is invaluable for pharmaceutical companies,
healthcare providers, and regulatory bodies. Accurate forecasts ensure
that adequate resources are allocated, regulatory guidelines are
appropriately tailored, and the medical community is prepared for shifts
in research focus. In this study, we explore the application of
Trend-based models and ARIMA (AutoRegressive Intergrated Moving Average)
models to detect underlying patterns and predict future study counts in
clinical trials. The motivation for this study lies in its potential to
streamline clinical trial management and enhance the strategic planning
of medical research.</p>
</div>
<div class="section level2">
<h2 id="research-question">Research Question<a class="anchor" aria-label="anchor" href="#research-question"></a>
</h2>
<p>The central inquiry of this project is to determine the trends in the
annual count of clinical trials and develop a predictive model that can
accurately forecast these numbers. This research seeks to answer two
primary questions: First, can we identify significant shifts in clinical
trial activity over time using trend-based model? Second, how well can
ARIMA models, which are traditionally used for time series forecasting,
predict the future count of clinical trials? By addressing these
questions, the research aims to contribute to the efficient planning and
execution of future clinical studies, which is critical for advancing
medical innovation and patient care.</p>
</div>
<div class="section level2">
<h2 id="data-cleaning-and-exploration">Data Cleaning and Exploration<a class="anchor" aria-label="anchor" href="#data-cleaning-and-exploration"></a>
</h2>
<p>In the following analysis, we will use the <code>yearly_count</code>
table from AACT database that showing the number of actual studies that
are started every year after 1990 (This dataset is generated from
studies dataset).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">bis620.2023</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'lubridate'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     date, intersect, setdiff, union</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/" class="external-link">forecast</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">##   method            from</span></span>
<span><span class="co">##   as.zoo.data.frame zoo</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data-inspection">Data Inspection<a class="anchor" aria-label="anchor" href="#data-inspection"></a>
</h3>
<p>The table <code>countries</code> has 467704 rows and 3 columns. The
<code>nct_id</code> column indicates the nct_id of the study that is
conducted; the <code>start_month_year</code> column shows the month and
year of study, <code>start_date_type</code> are showing what the start
status of the project. There are some missing value (NA) in both the
start_month_year and start_date_type columns.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complete_studies</span> <span class="op">=</span> <span class="va">studies_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">'nct_id'</span>, <span class="st">'start_date'</span>, <span class="st">'start_date_type'</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complete_studies</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          nct_id      start_date start_date_type </span></span>
<span><span class="co">##               0            5134          188311</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>The data cleaning process includes dropping rows that do not have
actually started (either estimated or NA) and those rows that without
specfiying the start date, selecting the appropriate time ranges(time
series of number of studies after 2000 (we believe this is an
appropriate number for our forecasting for 2023 and 2024)), and employ
function in dplyr to generate the target dataset. Note that although we
have data about 2023, we chose to neglect it due to the incompleteness
collection of the data for the year. For the sake of forecasting, we
separate the last two years as test dataset to evaluate the performance
of each model.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">complete_studies</span> <span class="op">[</span><span class="va">complete_studies</span><span class="op">$</span><span class="va">start_date_type</span> <span class="op">==</span> <span class="st">'Actual'</span>, <span class="op">]</span></span>
<span><span class="co"># Convert the 'start_date' column to datetime</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span>, format<span class="op">=</span><span class="st">"%Y-%m-%d"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove NAs and filter out dates before 2000 or after 2022</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">2022</span> <span class="op">&amp;</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2000</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract year from 'start_date'</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">start_date</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now group by 'year' and count the occurrences</span></span>
<span><span class="va">yearly_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Rename the columns appropriately</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">yearly_count</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Year'</span>, <span class="st">'Study_Count'</span><span class="op">)</span></span>
<span><span class="va">yearly_count</span><span class="op">$</span><span class="va">Year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">yearly_count</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yearly_count</span></span></code></pre></div>
<pre><code><span><span class="co">##    Year Study_Count</span></span>
<span><span class="co">## 1  2000         258</span></span>
<span><span class="co">## 2  2001         261</span></span>
<span><span class="co">## 3  2002         318</span></span>
<span><span class="co">## 4  2003         455</span></span>
<span><span class="co">## 5  2004         607</span></span>
<span><span class="co">## 6  2005         764</span></span>
<span><span class="co">## 7  2006        1002</span></span>
<span><span class="co">## 8  2007        1237</span></span>
<span><span class="co">## 9  2008        1546</span></span>
<span><span class="co">## 10 2009        1961</span></span>
<span><span class="co">## 11 2010        2481</span></span>
<span><span class="co">## 12 2011        3024</span></span>
<span><span class="co">## 13 2012        4095</span></span>
<span><span class="co">## 14 2013        5469</span></span>
<span><span class="co">## 15 2014        7598</span></span>
<span><span class="co">## 16 2015       11239</span></span>
<span><span class="co">## 17 2016       16250</span></span>
<span><span class="co">## 18 2017       25436</span></span>
<span><span class="co">## 19 2018       27200</span></span>
<span><span class="co">## 20 2019       28276</span></span>
<span><span class="co">## 21 2020       28513</span></span>
<span><span class="co">## 22 2021       31539</span></span>
<span><span class="co">## 23 2022       27734</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="data-visualization">Data Visualization<a class="anchor" aria-label="anchor" href="#data-visualization"></a>
</h3>
<p>In this visualization section, I choose to present two plots for the
purpose of exploratory data analysis (EDA) : Time Series Line Plot and
Study Count Histogram. The Time Series Line Plot shows us the trend of
clinical trial study counts over time, whereas allow us to visualize the
distribution of study counts across different years. We will then
leverage the result of EDA to explain the rationale of employing
trend-based models and ARIMA.</p>
<div class="section level4">
<h4 id="time-series-line-plot">Time Series Line Plot<a class="anchor" aria-label="anchor" href="#time-series-line-plot"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">yearly_count</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Year</span>, y<span class="op">=</span><span class="va">Study_Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30000</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">30000</span>, by<span class="op">=</span><span class="fl">5000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Time Series of Clinical Trial Study Counts"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Year"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Study Count"</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>From the graph, it appears that there is a noticeable upward trend,
particularly in recent years, indicating an increase in the number of
studies conducted. This increasing trend can affect the forecasting plan
by suggesting that trend-based model and ARIMA could capture the
essential component of this time series. Specifically, we will consider
a log-trend model because of the shape of this time series curve.</p>
</div>
<div class="section level4">
<h4 id="study-counts-histogram">Study Counts Histogram<a class="anchor" aria-label="anchor" href="#study-counts-histogram"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">yearly_count</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Study_Count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">30</span>, fill<span class="op">=</span><span class="st">"blue"</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Histogram of Clinical Trial Study Counts"</span>,</span>
<span>       x<span class="op">=</span><span class="st">"Study Count"</span>,</span>
<span>       y<span class="op">=</span><span class="st">"Frequency"</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>The distribution of study count actually informed us the possibility
of break in trend and the occurrence of some outliers. ARIMA and
trend-based model is somewhat sensitive to outliers. We would take them
into consideration while we proceed with caveat in this study.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>In this section, we will present our methodology of employment
trend-based models and ARIMA models thoroughly.</p>
<div class="section level3">
<h3 id="train-test-split">Train-Test Split<a class="anchor" aria-label="anchor" href="#train-test-split"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">split_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">yearly_count</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span></span>
<span><span class="va">training_set</span> <span class="op">&lt;-</span> <span class="va">yearly_count</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">split_row</span>, <span class="op">]</span></span>
<span><span class="va">test_set</span> <span class="op">&lt;-</span> <span class="va">yearly_count</span><span class="op">[</span><span class="op">(</span><span class="va">split_row</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">yearly_count</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">training_set</span></span></code></pre></div>
<pre><code><span><span class="co">##    Year Study_Count</span></span>
<span><span class="co">## 1  2000         258</span></span>
<span><span class="co">## 2  2001         261</span></span>
<span><span class="co">## 3  2002         318</span></span>
<span><span class="co">## 4  2003         455</span></span>
<span><span class="co">## 5  2004         607</span></span>
<span><span class="co">## 6  2005         764</span></span>
<span><span class="co">## 7  2006        1002</span></span>
<span><span class="co">## 8  2007        1237</span></span>
<span><span class="co">## 9  2008        1546</span></span>
<span><span class="co">## 10 2009        1961</span></span>
<span><span class="co">## 11 2010        2481</span></span>
<span><span class="co">## 12 2011        3024</span></span>
<span><span class="co">## 13 2012        4095</span></span>
<span><span class="co">## 14 2013        5469</span></span>
<span><span class="co">## 15 2014        7598</span></span>
<span><span class="co">## 16 2015       11239</span></span>
<span><span class="co">## 17 2016       16250</span></span>
<span><span class="co">## 18 2017       25436</span></span>
<span><span class="co">## 19 2018       27200</span></span>
<span><span class="co">## 20 2019       28276</span></span>
<span><span class="co">## 21 2020       28513</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_set</span></span></code></pre></div>
<pre><code><span><span class="co">##    Year Study_Count</span></span>
<span><span class="co">## 22 2021       31539</span></span>
<span><span class="co">## 23 2022       27734</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="evaluation-metrics">Evaluation Metrics<a class="anchor" aria-label="anchor" href="#evaluation-metrics"></a>
</h3>
<p>We chose to report MAPE and MSE for each models since we care the
absolute magnitude we miss and we might want to penalize more when the
forecast value is way off.</p>
</div>
<div class="section level3">
<h3 id="trend-based-model">Trend-based Model<a class="anchor" aria-label="anchor" href="#trend-based-model"></a>
</h3>
<p>Trend-based models are designed to capture and forecast systematic
long-term movements in time series data. The model incorporates this
trend to predict future values by extrapolating the established
direction of the data. In this study, we specifically focus on log-trend
model due to the shape of time series curve we observed.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">trend_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">)</span></span>
<span><span class="va">trend_train</span><span class="op">$</span><span class="va">log_study_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">trend_train</span><span class="op">$</span><span class="va">Study_Count</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating a time variable</span></span>
<span><span class="va">trend_train</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">trend_train</span><span class="op">$</span><span class="va">log_study_count</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitting a linear model to the log-transformed study counts against time</span></span>
<span><span class="va">log_trend_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">log_study_count</span> <span class="op">~</span> <span class="va">Time</span>, data <span class="op">=</span> <span class="va">trend_train</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">log_trend_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = log_study_count ~ Time, data = trend_train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.28570 -0.08994 -0.02840  0.04314  0.38356 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  5.05964    0.07095   71.32   &lt;2e-16 ***</span></span>
<span><span class="co">## Time         0.26115    0.00565   46.22   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1568 on 19 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9912, Adjusted R-squared:  0.9907 </span></span>
<span><span class="co">## F-statistic:  2136 on 1 and 19 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>We observe that both coefficient are statistically significance, and
we could choose to fit a quadratic model to see whether or not the
second order terms help.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a second-order term for Year</span></span>
<span><span class="va">trend_train</span><span class="op">$</span><span class="va">Time2</span> <span class="op">&lt;-</span> <span class="va">trend_train</span><span class="op">$</span><span class="va">Time</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Fit a second-order polynomial model (quadratic model)</span></span>
<span><span class="va">log_trend_model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">log_study_count</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Time2</span>, data <span class="op">=</span> <span class="va">trend_train</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary of the model to check the coefficients and other statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">log_trend_model_2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = log_study_count ~ Time + Time2, data = trend_train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.35805 -0.07730 -0.01766  0.04567  0.36947 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 5.155975   0.112652  45.769  &lt; 2e-16 ***</span></span>
<span><span class="co">## Time        0.236019   0.023586  10.007 8.84e-09 ***</span></span>
<span><span class="co">## Time2       0.001142   0.001041   1.097    0.287    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.156 on 18 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9917, Adjusted R-squared:  0.9908 </span></span>
<span><span class="co">## F-statistic:  1080 on 2 and 18 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<p>We observe that the coefficients of the second order term are not
statistically significant, and we stick with the previous model to make
test forecast.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecasting the next two periods</span></span>
<span><span class="co"># Create a new data frame for the future time periods</span></span>
<span><span class="va">future_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">trend_train</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict on the future times using the model</span></span>
<span><span class="va">log_forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">log_trend_model</span>, newdata <span class="op">=</span> <span class="va">future_times</span>, interval <span class="op">=</span> <span class="st">"confidence"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Back-transform forecasts to the original scale</span></span>
<span><span class="va">forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_forecasts</span><span class="op">[</span>, <span class="st">"fit"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">trend_forecasts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">2022</span><span class="op">)</span>, Forecast <span class="op">=</span> <span class="va">forecasts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the errors</span></span>
<span><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">test_set</span><span class="op">$</span><span class="va">Study_Count</span> <span class="op">-</span> <span class="va">forecasts</span></span>
<span></span>
<span><span class="co"># Mean Absolute Error (MAE)</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean Squared Error (MSE)</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">errors</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Squared Error (MSE):"</span>, <span class="va">mse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Squared Error (MSE): 813495202</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Absolute Error (MAE):"</span>, <span class="va">mae</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Absolute Error (MAE): 26979.07</span></span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trend_train</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Historical Data"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_set</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Actual Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trend_forecasts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Forecast</span>, color <span class="op">=</span> <span class="st">"Forecasted Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define the colors and the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Historical Data"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Actual Values"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Forecasted Values"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add titles and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Log Trend Model for Clinical Trial Study Count Analysis"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Study Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Based on the plot and metrics, it seems like the trend-based model
did poorly in actually capture the patterns. Hence, we consider a break
in trend model.</p>
</div>
<div class="section level3">
<h3 id="break-in-trend">Break in Trend<a class="anchor" aria-label="anchor" href="#break-in-trend"></a>
</h3>
<p>A break in a trend model, often referred to as a structural break or
change point, is an unexpected shift in a time series that can lead to
significant changes in the level or trend of the series.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">strucchange</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: zoo</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'zoo'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     as.Date, as.Date.numeric</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: sandwich</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">basic_trend_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Study_Count</span> <span class="op">~</span> <span class="va">Time</span>, data <span class="op">=</span> <span class="va">trend_train</span><span class="op">)</span></span>
<span><span class="va">breakpoints_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">Study_Count</span> <span class="op">~</span> <span class="va">Time</span>, data <span class="op">=</span> <span class="va">trend_train</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">breakpoints_model</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">breakpoints_model</span><span class="op">)</span></span></code></pre></div>
<p>Based on the RSS plot, we chose to set break point accordingly and
separate out the last_segment.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">last_segement</span> <span class="op">&lt;-</span> <span class="va">trend_train</span><span class="op">[</span><span class="va">trend_train</span><span class="op">$</span><span class="va">Time</span> <span class="op">&gt;</span> <span class="va">breaks</span><span class="op">$</span><span class="va">breakpoints</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="op">]</span></span>
<span><span class="va">break_in_trend_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Study_Count</span> <span class="op">~</span> <span class="va">Time</span>, data <span class="op">=</span> <span class="va">last_segement</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">break_in_trend_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Study_Count ~ Time, data = last_segement)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       15       16       17       18       19       20       21 </span></span>
<span><span class="co">## -1499.89 -1707.79  -545.68  4791.43  2706.54   -66.36 -3678.25 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept) -48635.5    10745.2  -4.526  0.00625 **</span></span>
<span><span class="co">## Time          3848.9      593.3   6.487  0.00130 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 3139 on 5 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.8938, Adjusted R-squared:  0.8726 </span></span>
<span><span class="co">## F-statistic: 42.08 on 1 and 5 DF,  p-value: 0.001298</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecasting the next two periods</span></span>
<span><span class="co"># Create a new data frame for the future time periods</span></span>
<span><span class="va">future_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">trend_train</span><span class="op">$</span><span class="va">Time</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict on the future times using the model</span></span>
<span><span class="va">break_in_trend_forecasts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">break_in_trend_model</span>, newdata <span class="op">=</span> <span class="va">future_times</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trend_forecasts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">2022</span><span class="op">)</span>, Forecast <span class="op">=</span> <span class="va">break_in_trend_forecasts</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the errors</span></span>
<span><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">test_set</span><span class="op">$</span><span class="va">Study_Count</span> <span class="op">-</span><span class="va">break_in_trend_forecasts</span></span>
<span></span>
<span><span class="co"># Mean Absolute Error (MAE)</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean Squared Error (MSE)</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">errors</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Squared Error (MSE):"</span>, <span class="va">mse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Squared Error (MSE): 84002590</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Absolute Error (MAE):"</span>, <span class="va">mae</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Absolute Error (MAE): 8328.089</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trend_train</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Historical Data"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_set</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Actual Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">trend_forecasts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">break_in_trend_forecasts</span>, color <span class="op">=</span> <span class="st">"Forecasted Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define the colors and the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Historical Data"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Actual Values"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Forecasted Values"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add titles and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Break in Trend Model for Clinical Trial Study Count Analysis"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Study Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>It seems that the break in trend model did much better than the
log-trend model, and we would further explore using more complex time
series model for this study.</p>
</div>
<div class="section level3">
<h3 id="arima-models">ARIMA Models<a class="anchor" aria-label="anchor" href="#arima-models"></a>
</h3>
<p>ARIMA stands for AutoRegressive Integrated Moving Average. It is a
class of models that explains a given time series based on its own past
values, meaning its lags and the lagged forecast errors, so that
equation can be used to forecast future values. An ARIMA model has three
components: AR (autoregression), I (integration), which involves
differencing the data to make it stationary, and MA (moving average).
This model is versatile and widely used for time series forecasting when
the data are stationary or can be made stationary through differencing.
It can handle complex and subtle stochastic structures in the data.</p>
<p>To indentify the order we conduct ADF test, and look at the PACF and
ACF plot.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span></span>
<span><span class="va">adf_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html" class="external-link">adf.test</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">$</span><span class="va">Study_Count</span>, alternative <span class="op">=</span> <span class="st">"stationary"</span><span class="op">)</span></span>
<span><span class="va">adf_result</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Augmented Dickey-Fuller Test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  training_set$Study_Count</span></span>
<span><span class="co">## Dickey-Fuller = -1.6952, Lag order = 2, p-value = 0.6885</span></span>
<span><span class="co">## alternative hypothesis: stationary</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">differenced_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">$</span><span class="va">Study_Count</span><span class="op">)</span></span>
<span><span class="va">adf_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html" class="external-link">adf.test</a></span><span class="op">(</span><span class="va">differenced_series</span>, alternative <span class="op">=</span> <span class="st">"stationary"</span><span class="op">)</span></span>
<span><span class="va">adf_result</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Augmented Dickey-Fuller Test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  differenced_series</span></span>
<span><span class="co">## Dickey-Fuller = -2.8296, Lag order = 2, p-value = 0.2563</span></span>
<span><span class="co">## alternative hypothesis: stationary</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">second_differenced_series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">$</span><span class="va">Study_Count</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adf_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tseries/man/adf.test.html" class="external-link">adf.test</a></span><span class="op">(</span><span class="va">second_differenced_series</span>, alternative <span class="op">=</span> <span class="st">"stationary"</span><span class="op">)</span></span>
<span><span class="va">adf_result</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Augmented Dickey-Fuller Test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  second_differenced_series</span></span>
<span><span class="co">## Dickey-Fuller = -3.3582, Lag order = 2, p-value = 0.08358</span></span>
<span><span class="co">## alternative hypothesis: stationary</span></span></code></pre>
<p>We found that the second difference of time series is stationary and
the order of I is 2.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">pacf</a></span><span class="op">(</span><span class="va">second_differenced_series</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">second_differenced_series</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-22-1.png" width="700">
Based on the PACF and ACF plot, we chose to employ ARIMA(0, 2, 1).</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arima_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></span><span class="op">(</span><span class="va">training_set</span><span class="op">$</span><span class="va">Study_Count</span>, order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">arima_model</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## arima(x = training_set$Study_Count, order = c(0, 2, 1))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##           ma1</span></span>
<span><span class="co">##       -0.2261</span></span>
<span><span class="co">## s.e.   0.2600</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## sigma^2 estimated as 3960520:  log likelihood = -171.31,  aic = 346.62</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/tsdiag.html" class="external-link">tsdiag</a></span><span class="op">(</span><span class="va">arima_model</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-24-1.png" width="700">
Based on the p values for Ljung-Box Statistic, our model is adequately
fitted.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">arima_model</span>, h<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">arima_forecasts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">2022</span><span class="op">)</span>, Forecast <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the errors</span></span>
<span><span class="va">errors</span> <span class="op">&lt;-</span> <span class="va">test_set</span><span class="op">$</span><span class="va">Study_Count</span> <span class="op">-</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">mean</span></span>
<span></span>
<span><span class="co"># Mean Absolute Error (MAE)</span></span>
<span><span class="va">mae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">errors</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean Squared Error (MSE)</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">errors</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Squared Error (MSE):"</span>, <span class="va">mse</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Squared Error (MSE): 4812681</span></span></code></pre>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Absolute Error (MAE):"</span>, <span class="va">mae</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Mean Absolute Error (MAE): 2170.306</span></span></code></pre>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">training_set</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Historical Data"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_set</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Actual Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arima_forecasts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"Forecasted Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Define the colors and the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Historical Data"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Actual Values"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"Forecasted Values"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add titles and labels</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ARIMA Model for Clinical Trial Study Count Analysis"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Study Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Based on the graph and evaluation metrics, ARIMA model peform
comparatively well than the trend-based model. In our understanding,
this could be the result from that ARIMA models explicitly account for
non-stationarity in the data through differencing (the â€˜Iâ€™ part of
ARIMA), whereas basic trend models may not adequately handle
non-stationary data that often result in spurious regressions. In
addition to that, ARIMA models can capture correlations in the time
series data at different lags through the AR and MA components. This
flexibility allows ARIMA to model a wide range of time series behaviors
that a simple trend model might miss, such as short-term fluctuations
and seasonal variations.</p>
<p>Hence, we utilize it to make forecast for the 2023 and 2024 after
combining training and test data.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arima_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html" class="external-link">arima</a></span><span class="op">(</span><span class="va">yearly_count</span><span class="op">$</span><span class="va">Study_Count</span>, order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">arima_model</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## arima(x = yearly_count$Study_Count, order = c(0, 2, 1))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##           ma1</span></span>
<span><span class="co">##       -0.4114</span></span>
<span><span class="co">## s.e.   0.2324</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## sigma^2 estimated as 5555387:  log likelihood = -192.96,  aic = 389.92</span></span></code></pre>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forecast_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/forecast.html" class="external-link">forecast</a></span><span class="op">(</span><span class="va">arima_model</span>, h<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">arima_forecasts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2023</span>, <span class="fl">2024</span><span class="op">)</span>, Forecast <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">yearly_count</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Study_Count</span>, color <span class="op">=</span> <span class="st">"Historical Data"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arima_forecasts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">mean</span>, color <span class="op">=</span> <span class="st">"Forecasted Values"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the forecast interval using geom_ribbon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">arima_forecasts_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, ymin <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">lower</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, ymax <span class="op">=</span> <span class="va">forecast_values</span><span class="op">$</span><span class="va">upper</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, fill <span class="op">=</span> <span class="st">"95% CI"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Historical Data"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"Forecasted Values"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"95% CI"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"ARIMA Model for Clinical Trial Study Count Analysis"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Study Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="research-ts-analysis_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion-and-discussion">Conclusion and Discussion<a class="anchor" aria-label="anchor" href="#conclusion-and-discussion"></a>
</h2>
<p>Based on our study, the ARIMA model provided a better fit for the
time series data of clinical trial study counts compared to the
trend-based model. This was evidenced by improved forecast accuracy
metrics, i.e.Â lower Mean Squared Error (MSE) and Mean Absolute Error
(MAE). After we identify the best model, we present the point forecast
and interval forecast for number of study will be started in 2023 and
2024. Despite that ARIMA model performs better than trend-based models,
this is still our first step towards tackling this forecasting problem,
and we acknowledge some limitations of using this approach. For example,
ARIMA model is sensitive to outliers and this could be observe a little
bit by how the forecasting trend shifting after a spike in 2021.
Therefore, further refinement and improvement of the model need to be
further explored to better understanding this time series and make
accurate forecast.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
